<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
</head>
<body>
    <canvas id="canvas" width="300" height="300" style="border: 1px solid black"></canvas>

    <script>
        const canvas = document.getElementById('canvas')
        const ctx = canvas.getContext('2d')

        let snakeH = snakeW = 5
        let dx = snakeW
        let dy = 0
        let canvasH = canvas.height
        let canvasW = canvas.width
        let rightPressed = leftPressed = upPressed = downPressed = false
        let foodX, foodY
        let snake = [
            {x: 10, y :10}
        ]

        drawSnake()
        drawFood()
        moveSnake()
        randomFood()
        snakeNavigation()

        function randomFood() {
            foodX = Math.floor(Math.random() * 290/5) * 5;
            foodY = Math.floor(Math.random() * 290/5) * 5;
        }

        function drawFood() {
            ctx.beginPath()
            ctx.rect(foodX,foodY,snakeW,snakeH)
            ctx.fillStyle="brown"
            ctx.fill()
            ctx.closePath()
        }

        function moveSnake() {
            setInterval(() => {
                handleDirection()

                growSnake()

                const head = {x : snake[0].x + dx, y: snake[0].y + dy }
                snake.unshift(head)
                snake.pop()

                ctx.clearRect(0,0,canvasW,canvasH)
                drawSnake()
                drawFood()
            }, 100);
        }

        function growSnake() {
            if(snake[0].x === foodX && snake[0].y === foodY){
                snake.push({x: foodX, y: foodY})
                randomFood()
            }
        }

        function drawSnake() {
            snake.forEach(snake => {
                ctx.beginPath()
                ctx.rect(snake.x,snake.y,snakeW,snakeH)
                ctx.fillStyle="black"
                ctx.fill()
                ctx.closePath()
            })
        }

        function handleDirection() {
            if(downPressed){
                    dy = snakeW
                    dx = 0
                }
                if(rightPressed){
                    dx = snakeW
                    dy = 0
                }
                if(leftPressed){
                    dx = -snakeW
                    dy = 0
                }
                if(upPressed){
                    dy = - snakeW
                    dx = 0
                }
        }

        function snakeNavigation() {
            document.addEventListener('keydown',handleKeyDown)
            document.addEventListener('keyup',handleKeyUp)

            function handleKeyDown(e) {
                if(e.key=== 'ArrowDown'){
                    downPressed = true
                }
                if(e.key=== 'ArrowUp'){
                    upPressed = true
                }
                if(e.key=== 'ArrowLeft'){
                    leftPressed = true
                }
                if(e.key=== 'ArrowRight'){
                    rightPressed = true
                }
            }

            function handleKeyUp(e) {
                if(e.key=== 'ArrowDown'){
                    downPressed = false
                }
                if(e.key=== 'ArrowUp'){
                    upPressed = false
                }
                if(e.key=== 'ArrowLeft'){
                    leftPressed = false
                }
                if(e.key=== 'ArrowRight'){
                    rightPressed = false
                }
            }
        }

    </script>
</body>
</html>